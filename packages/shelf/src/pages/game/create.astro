---
import ShelfLayout from "../_ShelfLayout.astro";
---
<ShelfLayout title="چاه بازی" description="" author="" key_words="" child_url="game">
  <div id="create_section" class="tc2 vbox flex flex-col aitems-center jcontent-center high-gap">

    <form class="flex flex-col low-gap" name="createForm" onsubmit="event.preventDefault()">
    <!-- <form class="flex flex-col low-gap" name="createForm" onsubmit="event.preventDefault()"> -->

      <input type="text" id="" name="game-title" placeholder="Game Title">
      <input type="text" id="" name="game-reld" placeholder="Game Release Date">
      <input type="number" id="" name="game-rate" placeholder="Game Rate">

      <select id="" name="game-platform">
        <option value="other">  Other     </option>
        <option value="xbox">   Xbox         </option>
        <option value="psx">    Psx      </option>
        <option value="pc">     Pc         </option>
      </select>

      <select id="" name="game-buy_state">
        <option value="wishlist">   Wishlist         </option>
        <option value="owned">      Owned         </option>
      </select>
      <input type="number" id="" name="game-buy_priority" placeholder="Game Buy Prio">


      <select name="game-play_state" id="">
        <option value="plan">     Plan         </option>
        <option value="playing">  Playing      </option>
        <option value="played">   Played         </option>
        <option value="drop">     Drop         </option>
      </select>
      <input type="number" id="" name="game-play_priority" placeholder="Game Play Prio">


      <button id="submitButton" type="submit" class="">ثبت</button>
    </form>

  </div>
</ShelfLayout>

<script>
  import PocketBase from 'pocketbase';
  const pb = new PocketBase("http://127.0.0.1:8090");

  const adminData = await pb.admins.authWithPassword('admin@example.com', 'admin@example.com');
  const records = await pb.collection('games').getFullList();
  console.log(records);

  let subB:any = document.querySelector("#submitButton");
  subB.addEventListener("click",()=>submitForm())

  async function submitForm() {    
    // Capture Form as X
    let x:any = document.forms["createForm"];

    const data = {
      "game_title":          x["game-title"].value,
      "release_date":        x["game-reld"].value,
      "game_rate":           x["game-rate"].value,
      
      "game_platform":       x["game-platform"].value,
      
      "game_buy_state":      x["game-buy_state"].value,
      "game_buy_priority":   x["game-buy_priority"].value,

      "game_play_state":     x["game-play_state"].value,
      "game_play_priority":  x["game-play_priority"].value,
    }

    console.log(data);

    const record = await pb.collection('games').create(data);

  }

</script>

<style>
  /* REMOVES number type input arrows */
    /* Chrome, Safari, Edge, Opera */
    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
    /* Firefox */
    input[type=number] {
      -moz-appearance: textfield;
    }
  /*  */

  a{text-decoration:none;font-size:small;font-weight: bold;}
  a:hover{text-decoration:underline;}

  #create_section{
    height:90vh;
  }
  form input,form button,form select{
    border-radius:4px;
    padding:4px 1rem;
    text-align:left;
  }
  form button{
    text-align:center;
    background-color:var(--c3);
    color:var(--c1);
    cursor: pointer;
  }
</style>