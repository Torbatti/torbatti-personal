---
import ShelfLayout from "../_ShelfLayout.astro";
---
<ShelfLayout title="چاه بازی" description="" author="" key_words="" child_url="game">
  <div id="create_section" class="tc2 vbox flex flex-col aitems-center jcontent-center high-gap">

    <form class="flex flex-col low-gap" name="createForm" onsubmit="event.preventDefault()">
    <!-- <form class="flex flex-col low-gap" name="createForm" onsubmit="event.preventDefault()"> -->

      <input type="text" id="" name="game-title" placeholder="Game Title">
      <input type="text" id="" name="game-developer" placeholder="Game Developer">
      <input type="text" id="" name="game-publisher" placeholder="Game Publisher">
      <input type="text" id="" name="game-genre" placeholder="Game Genre">

      <input type="number" id="" name="game-rate" placeholder="Game Rate">
      <input type="number" id="" name="game-play-time" placeholder="Game Play Time">
      <input type="text" id="" name="game-reld" placeholder="Game Release Date">

      <select name="game-state" id="">
        <option value="plan">     Plan         </option>
        <option value="playing">  Playing      </option>
        <option value="done">     Done         </option>
        <option value="wishlist"> Wishlist     </option>
        <option value="drop">     Drop         </option>
      </select>

      <button id="submitButton" type="submit" class="">ثبت</button>
    </form>

  </div>
</ShelfLayout>

<script>
  import PocketBase from 'pocketbase';
  const pb = new PocketBase("http://127.0.0.1:8090");

  const adminData = await pb.admins.authWithPassword('admin@example.com', 'admin@example.com');
  const records = await pb.collection('games').getFullList();
  console.log(records);

  let subB:any = document.querySelector("#submitButton");
  subB.addEventListener("click",()=>submitForm())

  async function submitForm() {    
    // Capture Form as X
    let x:any = document.forms["createForm"];

    const data = {
      "game_title":       x["game-title"].value,
      "game_developer":   x["game-developer"].value,
      "game_publisher":   x["game-publisher"].value,
      "game_genre":       x["game-genre"].value,
      "game_rate":        x["game-rate"].value,
      "play_time":        x["game-play-time"].value,
      "release_date":     x["game-reld"].value,
      "game_state":       x["game-state"].value,
    }

    console.log(data);

    const record = await pb.collection('games').create(data);

  }

</script>

<style>
  /* REMOVES number type input arrows */
    /* Chrome, Safari, Edge, Opera */
    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
    /* Firefox */
    input[type=number] {
      -moz-appearance: textfield;
    }
  /*  */

  a{text-decoration:none;font-size:small;font-weight: bold;}
  a:hover{text-decoration:underline;}

  #create_section{
    height:90vh;
  }
  form input,form button,form select{
    border-radius:4px;
    padding:4px 1rem;
    text-align:left;
  }
  form button{
    text-align:center;
    background-color:var(--c3);
    color:var(--c1);
    cursor: pointer;
  }
</style>