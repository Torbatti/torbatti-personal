---
import ShelfLayout from "../_ShelfLayout.astro";
---
<ShelfLayout title="کتابخانه" description="" author="" key_words="" child_url="book">
  <div id="create_section" class="tc2 vbox flex flex-col aitems-center jcontent-center high-gap">

    <form class="flex flex-col low-gap" name="createForm" onsubmit="event.preventDefault()">
    <!-- <form class="flex flex-col low-gap" name="createForm" onsubmit="event.preventDefault()"> -->

      <input type="text" id="" name="book_title" placeholder="book_title">

      <input type="text" id="" name="book_author" placeholder="book_author">
      <input type="text" id="" name="book_translator" placeholder="book_translator">
      <input type="text" id="" name="book_publisher" placeholder="book_publisher">

      <input type="text" id="" name="book_genre" placeholder="book_genre">

      <input type="text" id="" name="release_date" placeholder="release_date">
      <input type="number" id="" name="book_rate" placeholder="book_rate">
      

      <select name="book_series_type" id="">
        <option value="تک قسمت">  تک قسمت</option>
        <option value="مجموعه">  مجموعه</option>
      </select>
      <input type="text" id="" name="book_series_title" placeholder="book_series_title">
      <input type="text" id="" name="book_series_chapters" placeholder="book_series_chapters">

      <select name="book_buy_state" id="">
        <option value="دارا">  دارا</option>
        <option value="خواهان">  خواهان</option>
      </select>
      <input type="number" id="" name="book_buy_priority" placeholder="book_buy_priority">
      

      <select name="book_read_state" id="">
        <option value="انتظار">  انتظار</option>
        <option value="درحال">  درحال</option>
        <option value="خوانده">  خوانده</option>
        <option value="پرتاب">  پرتاب</option>
      </select>
      <input type="number" id="" name="book_read_priority" placeholder="book_read_priority">


      <select name="book_paper_type" id="">
        <option value="فیزیکی">  فیزیکی</option>
        <option value="مجازی">  مجازی</option>
      </select>


      <button id="submitButton" type="submit" class="">ثبت</button>

    </form>

  </div>
</ShelfLayout>

<script>
  import PocketBase from 'pocketbase';
  const pb = new PocketBase("http://127.0.0.1:8090");

  const adminData = await pb.admins.authWithPassword('admin@example.com', 'admin@example.com');
  const records = await pb.collection('books').getFullList();
  console.log(records);

  let subB:any = document.querySelector("#submitButton");
  subB.addEventListener("click",()=>submitForm())

  async function submitForm() {    
    // Capture Form as X
    let x:any = document.forms["createForm"];

    const data = {
      "book_title":       x["book_title"].value,

      "book_author":       x["book_author"].value,
      "book_translator":       x["book_translator"].value,
      "book_publisher":       x["book_publisher"].value,

      "release_date":       x["release_date"].value,
      "book_genre":       x["book_genre"].value,
      "book_rate":       x["book_rate"].value,

      "book_series_type":       x["book_series_type"].value,
      "book_series_title":       x["book_series_title"].value,
      "book_series_chapters":       x["book_series_chapters"].value,

      "book_buy_state":       x["book_buy_state"].value,
      "book_buy_priority":       x["book_buy_priority"].value,

      "book_read_state":       x["book_read_state"].value,
      "book_read_priority":       x["book_read_priority"].value,

      "book_paper_type":       x["book_paper_type"].value,
    }

    console.log(data);

    const record = await pb.collection('books').create(data);

  }

</script>

<style>
  /* REMOVES number type input arrows */
    /* Chrome, Safari, Edge, Opera */
    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
    /* Firefox */
    input[type=number] {
      -moz-appearance: textfield;
    }
  /*  */

  a{text-decoration:none;font-size:small;font-weight: bold;}
  a:hover{text-decoration:underline;}

  #create_section{
    height:90vh;
  }
  form input,form button,form select{
    border-radius:4px;
    padding:4px 1rem;
    text-align:left;
  }
  form button{
    text-align:center;
    background-color:var(--c3);
    color:var(--c1);
    cursor: pointer;
  }
</style>